---
lab: 4
title: 练习 3 - 数据丢失防护
---

# 实验室 4 - 练习 3 - 数据丢失防护

Contoso Ltd. 目前正在将 Tailwind Traders 集成到其项目中。 尽管合并仍在进行中，但两家公司都在单独的租户内运营。 Tailwind Traders 员工被视为外部用户，并受邀作为来宾加入 Contoso 的租户，以方便共享 SharePoint 站点和文件。 在某些项目中，选定的 Tailwind Traders 员工会收到由 Contoso Ltd. 托管的 Windows 11 客户端，以确保在保持安全监督的同时，对内部资源具有完全访问权限。 非托管设备访问 M365 桌面应用程序将被阻止，这些用户只能通过 Web 应用程序访问环境。 托管设备受到 Endpoint Manager 中各种策略的保护。 Contoso Ltd. 已实现 Microsoft Purview 信息保护，以基于敏感文档包含的信息类型对其进行加密。 

作为网络安全架构师，你最近检查了 Defender for Cloud Apps 活动日志中的各种活动，发现一些标记为机密的文档正在复制到外部 U 盘。 你还发现，用户可以在其非托管个人设备上自由存储他们有权访问的任何公司数据。 这构成需要解决的重大问题。 作为解决方案，你将设计安全策略以限制在非托管个人设备上存储公司数据。 这有助于最大程度降低敏感数据被盗用的风险。

## 第 1 部分：设计解决方案（必需）

在此任务中，你将设计一个概念来应对 Contoso Ltd. 面临的风险。

### 设计方法

第一步涉及根据描述的问题分析需求、理解目标以及定义需求。

根据提供的用例，可以概述以下要求：

- 防止将数据传输到 U 盘
- 限制从非托管设备访问敏感数据
- 阻止从非托管设备下载敏感数据

第二步，检查 Contoso Ltd. 的现有环境。 Microsoft Purview 和 Microsoft Defender 提供各种用于管理数据流的解决方案，包括 Microsoft Purview 信息保护、数据丢失防护、条件访问和保留策略。 调查已制定哪些控制措施。 访问各种门户以查看当前配置和策略，确定是否需要调整或是否需要实现新的设置/策略。

第三阶段涉及制定解决方案概念。 经过调查，很明显当前策略均不符合规定的要求。 因此，制定一组新的策略至关重要。

### 建议的解决方案

设计安全策略以限制在非托管个人设备上存储公司数据。 这有助于最大程度降低敏感数据被盗用的风险。 该策略应概述被视为敏感数据类型以及可以存储这些数据的可接受设备。 此外，该策略还应提供将数据安全传输到外部设备的准则。 应要求员工签署协议，承认其理解该策略并承诺遵守该策略。 应向所有员工传达该策略，并通过定期审计和对违规行为实施纪律处分来加强执行该策略。 还应定期进行课程培训，确保员工知晓与在个人设备上存储公司数据相关的风险以及遵守该策略的重要性。 最后，应定期审查和更新策略，确保该策略的持续有效性和相关性。 

|要求|解决方案|操作计划|
|----|----|----|
|阻止将数据移动到 U 盘|终结点数据丢失防护|阻止将所有带敏感标签的数据复制到 U 盘|
|限制从非托管设备访问敏感数据|Defender for Cloud Apps|阻止非托管设备复制/剪切/粘贴数据|
|阻止从非托管设备下载敏感数据|Defender for Cloud Apps|阻止从非托管设备下载数据|

## 第 2 部分：实施解决方案（可选）

### 任务 1：部署数据丢失防护策略

解决方案设计的第一步是为终结点创建数据丢失防护规则。 你将部署 DLP 规则以阻止将数据复制到 U 盘。 

1. 使用 Allan Deyoung 的管理员帐户 **MOD 管理员**并以其身份登录到 Microsoft Purview 合规门户**https://compliance.microsoft.com**。
1. 如果系统提示切换回经典 Microsoft Purview 合规门户，请选择“**切换**”。
1. 在 Microsoft Purview 门户的左侧导航窗格中，展开“**数据丢失防护**”，然后选择“**策略**”。
1. 在“策略”页上，选择“+ 创建策略” 。
1. 在“**从模板开始或创建自定义策略**”页上，依次选择“**自定义**”、“**自定义策略**”和“**下一步**”。
1. 在“**为 DLP 策略命名**”页上，输入名称和说明，然后选择“**下一步**”。
1. 在“分配管理单元”**** 页上，选择“下一步”****。
1. 在“**选择应用策略的位置**”页上，仅选择“**设备**”，然后选择“**下一步**”。
1. 在“**定义策略设置**”页上，选择“**下一步**”。
1. 在“**自定义高级 DLP 规则**”页上，选择“**+ 创建规则**”。
1. 输入规则名称和说明。 
1. 在“**条件**”下选择“**+ 添加条件**”，然后选择“**内容包含**”。
1. 指定以下条件：

    - **内容包含**： 
      - 选择“**添加**”，选择“**敏感度标签**”，然后选择“**受信任人员**”、“**项目 - 猎鹰**”、“**机密**”、“**高度机密**”、“**机密 - 财务**”标签。 单击“添加” 。
13. 在“**操作**”下，选择“**+ 添加操作**”，然后选择“**审核或限制设备上的活动**”。
14. 指定以下操作：
   -    在“**所有应用的文件活动**”下，选择“**对特定活动应用限制**”。
      - 确保已选择“**复制到可移动 USB 设备**”，并从此设置的下拉菜单中选择“**阻止**”选项。
      - 保持其他设置不变。
15. 选择“保存”。
16. 选择**下一步**。
17. 在“策略模式”**** 页上，选择“立即启用策略”****。 选择**下一步**。
18.  在“查看并完成”页上，选择“提交”********。

已成功实现阻止将数据复制到 U 的数据丢失防护策略。

### 任务 2：将应用程序载入条件访问应用控制

解决方案的一部分是在 Defender for Cloud Apps 中创建会话策略。 会话策略通过实时监视会话提供对云应用程序的全面见解。 这些策略根据每个用户会话的指定策略启用定制操作。 为了创建会话策略，需要在应用程序上部署条件访问应用控制。 条件访问应用控制为应用添加实时监视和控制功能。 在未将任何应用载入条件访问应用控制的情况下创建会话策略将不起作用。 第一步是将要保护的应用程序载入条件访问应用控制。 

可通过 2 种方法将应用程序载入条件访问应用控制：

- 在 Microsoft Defender 门户中手动添加应用程序（“设置”>“云应用”>“连接的应用”>“条件访问应用控制应用”）
- 配置条件访问策略以使用 Defender for Cloud Apps 保护应用

条件访问策略将策略中指定的所有应用程序转发到“Defender for Cloud Apps 条件访问应用控制”。 用户下次登录到指定应用程序时，相应的应用程序会自动添加到条件访问应用控制。 可以在 Microsoft Defender 门户中查看这些应用程序。 
 
>**提示：** 启动此任务之前，应检查现有的条件访问应用控制应用。 你会注意到尚未载入任何应用程序。 在此阶段，请尝试在 Defender for Cloud Apps 中创建会话策略并检查出现的错误消息。

在此任务中，在 Microsoft Entra 中创建条件访问策略以在应用程序上部署条件访问应用控制。 

1. 使用 Allan Deyoung 的管理员帐户 **MOD 管理员**并以其身份登录到 Microsoft Entra 门户**https://entra.microsoft.com**。
2. 在 Microsoft Entra 门户中，展开“**保护**”并选择“**条件访问**”。
3. 在“**条件访问中 | 概述**”页选择“**策略**”，然后选择“**+ 新建策略**”。
4. 为策略输入名称。
5. 在“**分配**”下，选择“**用户**”并包含“**所有用户**”。
6. 在“**分配**”下选择“**目标资源**”，并包含“**所有云应用**”。
7. 在“**访问控制**”下，选择“**会话**”。
8. 在“**会话**”窗格中，选择“**使用条件访问应用控制**”，并选择“**使用自定义策略...”**，然后使用“**选择**”按钮来关闭“**会话**”窗格。
9. 在“**启用策略**”下，选择“**开启**”。
10. 如果收到要将当前用户排除在策略之外的警告，请选择“**我知道我的帐户将受到此策略的影响。请继续执行。**”。
11. （可选）指定条件并授权控制。
12. 选择**创建**。

现在登录到其中一个 Microsoft Web 应用，例如 [Outlook](https://outlook.office365.com)。 登录的应用程序将自动加入条件访问应用控制。 登录到 Microsoft Defender 门户，并在条件访问应用控制下查看应用程序。

你已成功创建条件访问策略，将所有应用程序转发到 Defender for Cloud Apps，并将应用加入条件访问应用控制。

### 任务 3：在 Defender for Cloud Apps 中创建会话策略

你将在 Defender for Cloud Apps 中创建两个会话策略，以阻止下载数据并限制非托管设备的权限。

1. 使用 Allan Deyoung 的管理员帐户 **MOD 管理员**并以此身份登录到 Microsoft Defender 门户**https://security.microsoft.com**。
1. 在 Microsoft 安全门户中，选择“**云应用**” > “**策略**” > “**策略策略管理**”。
1. 在“**策略**”页上，选择“**+ 创建策略**” > “**会话策略**”。
1. 在“**创建会话策略**”页上，选择策略模板“**根据实时内容检查阻止下载**”。
1. 输入策略名称。
1. 选择策略严重性和类别。
1. 输入说明。
1. 在“**会话控制类型**”下，选择“**控制文件下载(通过检查)**”。
1. 在“**符合以下所有条件的活动**”中的“**活动源**”下，选择以下筛选器：

    - **设备标签**：选择“**不等于**”，然后选择“**Intune 兼容**”。

10. 在“**符合以下所有条件的文件**”部分，选择以下筛选器：

    - **敏感度标签**：选择“**等于**”，然后选择标签“**机密**”、“**高度机密**”和“**机密 - 财务**”。

11. 在“**检查方法**”下，选择“**数据分类服务**”，然后选择“**任何**”，接着选择“**敏感度信息类型...**”，并选择希望应用此策略的适当敏感信息类型。
12. 在“**操作**”下，选择“**阻止**”。
13. 选择“创建”创建策略。
14. 按照上述说明创建第二个策略，并选择策略模板“**根据实时内容检查阻止剪切/复制和粘贴**”。
15. 在“**符合以下所有条件的活动**”中的“**活动源**”下，输入以下信息： 

    - **活动类型**：选择“**等于**”，然后选择“**剪切/复制项、粘贴项**”
    - **设备标签**：选择“**不等于**”，然后选择“**Intune 兼容**”

16. 禁用“**使用内容检查**”并选择“**创建**”以创建策略。

你已成功在 Defender for Cloud Apps 中创建两个会话策略。
